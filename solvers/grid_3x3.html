<script>
const cols = 3;
const rows = 3;

let c = 0;
let r = 0;
const objs = [];

function c_object(c, r) {
	this.c = c;
	this.r = r;
	this.left_blockers  = [];
	this.right_blockers = [];
	this.up_blockers    = [];
	this.down_blockers  = [];
}

c_object.prototype.can = function(m) {	
	if (m === 'left') {
		if (c === 0) return false;
		for (let i = 0; i < objs.length; ++i) {
			const o = objs[i];
			if (o.c === this.c - 1 && o.r === this.r) {
				for (let j = 0; j < objs.length; ++j) {
					if (this.left_blockers.includes(objs[j].prototype.constructor)) {
						return false;
					}
				}
			}
		}
	} else if (m === 'right') {
		if (c === cols - 1) return false;
		for (let i = 0; i < objs.length; ++i) {
			const o = objs[i];
			if (o.c === this.c + 1 && o.r === this.r) {
				for (let j = 0; j < objs.length; ++j) {
					if (this.right_blockers.includes(objs[j].prototype.constructor)) {
						return false;
					}
				}
			}
		}
	} else if (m === 'up') {
		if (r === 0) return false;
		for (let i = 0; i < objs.length; ++i) {
			const o = objs[i];
			if (o.c === this.c && o.r === this.r - 1) {
				for (let j = 0; j < objs.length; ++j) {
					if (this.up_blockers.includes(objs[j].prototype.constructor)) {
						return false;
					}
				}
			}
		}
	} else if (m === 'down') {
		if (r === rows - 1) return false;
		for (let i = 0; i < objs.length; ++i) {
			const o = objs[i];
			if (o.c === this.c && o.r === this.r + 1) {
				for (let j = 0; j < objs.length; ++j) {
					if (this.down_blockers.includes(objs[j].prototype.constructor)) {
						return false;
					}
				}
			}
		}
	} else {
		throw new Error('invalid move');
	}
	return true;
};

c_object.prototype.move = function(m) {
	if (m === 'left') --this.c;
	else if (m === 'right') ++this.c;
	else if (m === 'up') --this.r;
	else ++this.r;
};

function c_hazard_left(c, r) {
	this.c = c;
	this.r = r;
}

function c_hazard_right(c, r) {
	this.c = c;
	this.r = r;
}

function c_hazard_up(c, r) {
	this.c = c;
	this.r = r;
}

function c_hazard_down(c, r) {
	this.c = c;
	this.r = r;
}

function c_left1(c, r) {
	c_object.call(this, c, r);
	this.left_blockers.push(c_right1);
}

function c_right1(c, r) {
	c_object.call(this, c, r);
}

function c_up1(c, r) {
	c_object.call(this, c, r);
}

function c_down1(c, r) {
	c_object.call(this, c, r);
}

function c_left2(c, r) {
	c_object.call(this, c, r);
}

function c_right2(c, r) {
	c_object.call(this, c, r);
}

function c_up2(c, r) {
	c_object.call(this, c, r);
}

function c_down2(c, r) {
	c_object.call(this, c, r);
}

c_left1.prototype  = Object.create(c_object.prototype);
c_right1.prototype = Object.create(c_object.prototype);
c_up1.prototype    = Object.create(c_object.prototype);
c_down1.prototype  = Object.create(c_object.prototype);

c_left2.prototype  = Object.create(c_object.prototype);
c_right2.prototype = Object.create(c_object.prototype);
c_up2.prototype    = Object.create(c_object.prototype);
c_down2.prototype  = Object.create(c_object.prototype);

Object.defineProperty(c_left1.prototype , 'constructor', { value: c_left1 , enumerable: false, writable: true });
Object.defineProperty(c_right1.prototype, 'constructor', { value: c_right1, enumerable: false, writable: true });
Object.defineProperty(c_up1.prototype   , 'constructor', { value: c_up1   , enumerable: false, writable: true });
Object.defineProperty(c_down1.prototype , 'constructor', { value: c_down1 , enumerable: false, writable: true });

Object.defineProperty(c_left2.prototype , 'constructor', { value: c_left2 , enumerable: false, writable: true });
Object.defineProperty(c_right2.prototype, 'constructor', { value: c_right2, enumerable: false, writable: true });
Object.defineProperty(c_up2.prototype   , 'constructor', { value: c_up2   , enumerable: false, writable: true });
Object.defineProperty(c_down2.prototype , 'constructor', { value: c_down2 , enumerable: false, writable: true });

// c_left1.prototype.can = function(m) {
// 	if (!c_object.prototype.can.call(this)) return false;
// 	for (let i = 0; i < objs.length; ++i) {
// 		const o = objs[i];
// 		if (o === this) continue;
// 		if (o.r !== this.r) continue;
// 		if (o.c !== this.c - 1) continue;
// 		if (o instanceof c_right2) continue;
// 		return false;
// 	}
// 	return true;
// }

const r1 = new c_right1(0, 1);
const l1 = new c_left1(1, 1);
objs.push(r1, l1);
console.log(l1.can('left'));
console.log(l1.can('right'));




/*


	let c = 2;
	let r = 0;
	let dc = 2;
	let dr = 0;
	let rc = 1;
	let rr = 1;
	let uc = 0;
	let ur = 2;
	let Rc = 2;
	let Rr = 0;
	let Lc = 1;
	let Lr = 2;
	
	function state() {
		return '' + c + r + dc + dr + rc + rr + uc + ur + Rc + Rr + Lc + Lr;
	}

	function expand(s) {
		c  = parseInt(s.at(0));
		r  = parseInt(s.at(1));
		dc = parseInt(s.at(2));
		dr = parseInt(s.at(3));
		rc = parseInt(s.at(4));
		rr = parseInt(s.at(5));
		uc = parseInt(s.at(6));
		ur = parseInt(s.at(7));
		Rc = parseInt(s.at(8));
		Rr = parseInt(s.at(9));
		Lc = parseInt(s.at(10));
		Lr = parseInt(s.at(11));
	}

	function hazard() {
		// if (c === 1 && r === 2) {
		// 	if (rc === c && rr === r) return false;
		// 	if (uc === c && ur === r) return false;
		// 	if (Lc === c && Lr === r) return false;
		// 	if (Rc === c && Rr === r) return false;
		// 	return true;
		// }
		if (c === 2 && r === 2) {
			if (uc === c && ur === r) return false;
			if (Lc === c && Lr === r) return false;
			return true;
		}
		return false;
	}

	function goal() {
		if (c === 0 && r === 2) {
			if (dc === c && dr === r) return false;
			if (rc === c && rr === r) return false;
			if (uc === c && ur === r) return false;
			if (Rc === c && Rr === r) return false;
			return true;
		}
		return false;
	}

	const moves = ['left', 'right', 'up', 'down'];

	function can(move) {
		if (move === 'left') {
			if (c === 0) return false;
			if (dr === r && dc === c - 1) return false;
			if (rr === r && rc === c - 1) {
				if (dc === c && dr === r) return false;
				if (uc === c && ur === r) return false;
				if (Rc === c && Rr === r) return false;
			}
			if (ur === r && uc === c - 1) return false;
			if (Lr === r && Lc === c - 1) return false;
			return true;
		} else if (move === 'right') {
			if (c === 2) return false;
			if (dr === r && dc === c + 1) return false;
			if (rr === r && rc === c + 1) return false;
			if (ur === r && uc === c + 1) return false;
			if (Rr === r && Rc === c + 1) return false;
			return true;
		} else if (move === 'up') {
			if (r === 0) return false;
			if (dr === r && dc === r - 1) {
				if (rc === c && rr === r) return false;
				if (Lc === c && Lr === r) return false;
				if (Rc === c && Rr === r) return false;
			}
			if (rc === c && rr === r - 1) return false;
			if (uc === c && ur === r - 1) return false;
			if (Lc === c && Lr === r - 1) return false;
			if (Rc === c && Rr === r - 1) return false;
			return true;
		} else if (move === 'down') {
			if (r === 2) return false;
			if (dc === c && dr === r + 1) return false;
			if (rc === c && rr === r + 1) return false;
			if (uc === c && ur === r + 1) {
				if (rc === c && rr === r) return false;
				if (Lc === c && Lr === r) return false;
				if (Rc === c && Rr === r) return false;
			}
			if (Lc === c && Lr === r + 1) return false;
			if (Rc === c && Rr === r + 1) return false;
			return true;
		} else {
			throw new Error('invalid move');
		}
	}

	function go(move) {
		if (move === 'left') {
			if (dc === c && dr === r) --dc;
			if (rc === c && rr === r) --rc;
			if (uc === c && ur === r) --uc;
			if (Rc === c && Rr === r) --Rc;
			--c;
		} else if (move === 'right') {
			if (dc === c && dr === r) ++dc;
			if (rc === c && rr === r) {
				if (Lc === c && Lr === r) ++rc;
			}
			if (uc === c && ur === r) ++uc;
			if (Lc === c && Lr === r) ++Lc;
			++c;
		} else if (move === 'up') {
			if (dc === c && dr === r) --dr;
			if (rc === c && rr === r) --rr;
			if (uc === c && ur === r) {
				if (Rc === c && Rr === r || Lc === c && Lr === r) --ur;
			}
			if (Lc === c && Lr === r) --Lr;
			if (Rc === c && Rr === r) --Rr;
			--r;
		} else if (move === 'down') {
			if (dc === c && dr === r) {
				if (Lc === c && Lr === r || Rc === c && Rr === r) ++dr;
			}
			if (rc === c && rr === r) ++rr;
			if (uc === c && ur === r) ++ur;
			if (Lc === c && Lr === r) ++Lr;
			if (Rc === c && Rr === r) ++Rr;
			++r;
		} else {
			throw new Error('invalid move');
		}
	}

	/////////////////////////////////////////////////////////////////////////////
	//
	// start generic code
	//
	/////////////////////////////////////////////////////////////////////////////

	const paths = new Map();
	paths.set(state(), []); // initial state
	solution = null;
	let visits = 0;

	function visit(s) {
		++visits;
		const p = paths.get(s);
		if (solution !== null && solution.length <= p.length + 1) {
			return;
		}
		const child_states = [];
		moves.forEach(move => {
			expand(s);
			if (can(move)) {
				go(move);
				if (hazard()) return;
				if (paths.has(state()) && paths.get(state()).length <= p.length + 1) return;
				paths.set(state(), p.concat(move));
				if (goal()) {
					solution = paths.get(state());
				} else {
					child_states.push(state());
				}
			}
		});
		child_states.forEach(s => visit(s));
	}

	visit(state());
	
	document.writeln("<pre>")
//	document.writeln('running with max_path_length ' + max_path_length);
	document.writeln('states visited: ' + visits);
	if (solution === null) {
		document.writeln('solution not found');
	} else {
		document.writeln('moves: ' + solution.length);
		solution.forEach(move => document.writeln(move));
	}
	document.writeln("</pre>")
	*/
	</script>
	